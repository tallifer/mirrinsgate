<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mirrin's Gate Journal</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <style>
    body {
        margin: 0;
        font-family: 'Georgia', serif;
        background: url('images/background.png') repeat;
        background-size: cover;
        background-attachment: fixed;
        background-position: top center;
        color: #3a2a18;
    }

    /* Fixed header */
    #siteHeader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000;
        background: rgba(255, 248, 230, 0.95);
        border-bottom: 2px solid #b28c5b;
        text-align: center;
        padding: 12px 20px;  /* reduced from 25px */
        font-size: 0.8rem;   /* reduced from 2.5rem */
        line-height: 1.2;
        box-sizing: border-box;
    }

    #sidebar {
    top: 80px; /* reduced from 120px */
    max-height: calc(100vh - 100px);
}

#content {
    margin-top: 80px; /* reduced from 120px */
}

.post {
    scroll-margin-top: 100px; /* reduced from 140px */
}


    /* Layout container */
    .journal-container {
        max-width: 1200px;
        margin: 0 auto;
        display: block;
        padding: 0 20px;
        box-sizing: border-box;
    }

    /* Sidebar fixed */
    #sidebar {
        position: fixed;
        top: 120px; /* just below the header */
        left: 20px;
        width: 250px;
        background: rgba(255, 248, 230, 0.95);
        border: 2px solid #b28c5b;
        border-radius: 10px;
        padding: 20px;
        box-sizing: border-box;
        max-height: calc(100vh - 140px);
        overflow-y: auto;
    }

    #sidebar h2 {
      font-size: 1.2rem;
      margin-bottom: 10px;
    }

    #sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #sidebar li {
      margin: 10px 0;
    }

    #sidebar a {
      text-decoration: none;
      color: #3a2a18;
    }

    #sidebar a:hover {
      text-decoration: underline;
    }

    /* Main content scrolls */
    #content {
        margin-left: 300px; /* room for sidebar */
        margin-top: 120px;  /* room for header */
    }

    .post {
        background: rgba(255, 248, 230, 0.9);
        border: 2px solid #b28c5b;
        padding: 20px;
        margin: 40px auto;
        max-width: 800px;
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        scroll-margin-top: 140px; /* avoids header overlap */
    }

    .post img {
        max-width: 100%;
        margin: 15px 0;
        border-radius: 8px;
    }

    html {
        scroll-behavior: smooth;
    }

    .back-button {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        background: #b28c5b;
        color: #fff;
        text-decoration: none;
        padding: 8px 16px;
        border-radius: 6px;
        font-family: 'Georgia', serif;
        font-size: 1rem;
        transition: background 0.2s ease;
    }

    .back-button:hover {
        background: #8c6d45;
    }

  </style>
</head>
<body>
  <header id="siteHeader">
  <h1>Mirrin's Gate Journal</h1>
  <a href="town.html" class="back-button">‚Üê Back to Mirrin's Gate</a>
</header>

  <div class="journal-container">
    <div id="sidebar">
      <h2>Posts</h2>
      <ul id="postList"></ul>
    </div>

    <div id="content">
      <div id="posts"></div>
    </div>
  </div>

  <script>
    async function loadPosts() {
      try {
        const response = await fetch('data/posts.json');
        const posts = await response.json();
        const postsContainer = document.getElementById('posts');
        const postList = document.getElementById('postList');

        posts.forEach((post, index) => {
          // Create post content
          const div = document.createElement('div');
          div.className = 'post';
          div.id = `post-${index}`;

          let content = `<h2>${post.title}</h2>`;
          if (post.image) {
            content += `<img src="${post.image}" alt="${post.title}">`;
          }
          content += `<div>${marked.parse(post.markdown)}</div>`;
          div.innerHTML = content;
          postsContainer.appendChild(div);

          // Add to sidebar list
          const li = document.createElement('li');
          li.innerHTML = `<a href="#post-${index}">${index + 1}. ${post.title}</a>`;
          postList.appendChild(li);
        });
      } catch (err) {
        console.error('Failed to load posts:', err);
      }
    }

    loadPosts();
  </script>

</body>
</html>
